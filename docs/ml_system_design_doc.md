# ML System Design Doc - Рекомендация релевантной рекламы

---

## 1. Цели и предпосылки

### 1.1. Зачем идем в разработку продукта?

- **Бизнес-цель Product Owner**:  
  Платформа Avito.tech хочет повысить эффективность рекламных кампаний, предоставляя пользователям наиболее релевантные объявления. В результате этого предполагается увеличение CTR (Click-Through Rate) и улучшение ROI (Return on Investment) для рекламодателей.

- **Почему станет лучше, чем сейчас, от использования ML (Product Owner & Data Scientist)**:  
  Использование ML-моделей для предсказания вероятности клика обеспечит:
  - Персонализированные рекомендации, что повысит удовлетворенность пользователей.
  - Снижение расходов на неэффективные показы, что приведет к более высокому ROI для рекламодателей.

- **Что будем считать успехом итерации с точки зрения бизнеса (Product Owner)**:  
  Успехом будет считаться:
  - Достижение неплохой точности в предсказаниях модели (ROC AUC ≥ 0.55).
  - Увеличение CTR.
  - Уменьшение затрат на рекламу с учётом роста отклика пользователей.

---

### 1.2. Бизнес-требования и ограничения

- **Краткое описание БТ и ссылки на детальные документы с бизнес-требованиями (Product Owner)**:  
  Основное бизнес-требование — создание модели, предсказывающей вероятность клика по рекламному объявлению.

- **Бизнес-ограничения (Product Owner)**:  
  1. Модель должна работать с анонимизированными данными пользователей, не нарушая требования GDPR.
  2. Требования к скорости модели: предсказания должны быть сгенерированы в онлайне (за несколько десятков миллисекунд).
  3. Для первого запуска не требуется использование нейросетевых моделей, решение доложно работать без GPU.

- **Что мы ожидаем от конкретной итерации (Product Owner)**:  
  Итерация должна привести к созданию работающего прототипа модели, который будет оцениваться по метрике качества ROC-AUC. Модель должна продемонстрировать улучшение в точности предсказаний по сравнению с бейзлайном - если пользователь уже увидел и кликнул на рекламу - он кликнет снова.

- **Описание бизнес-процесса пилота (Product Owner)**:  
  Модель может быть использована в качестве модели первого уровня в общем пайплайне рекомендации рекламы для отсева кандидатов и генерации дополнительной фичи, которая поможет модели градиентного бустинга в ранжировании.

- **Что считаем успешным пилотом? Критерии успеха и возможные пути развития проекта (Product Owner)**:  
  Пилот считается успешным, если:
  - Побит порог ROC AUC ≥ 0.55 (цифра взята исходя из анализа лидерборда открытого соревнования, в котором использовались эти данные).
  - Для работы модели не требуется GPU.

---

### 1.3. Что входит в скоуп проекта/итерации, что не входит

- **На закрытие каких БТ подписываемся в данной итерации (Data Scientist)**:  
  В рамках итерации мы закрываем создание рабочей модели для предсказания кликов на основе данных о взаимодействиях пользователей с рекламой и характеристиках рекламных кампаний. Ожидается, что модель будет обучена на исторических данных и провалидирована.

- **Что не будет закрыто (Data Scientist)**:  
  - Модели для прогнозирования других метрик (например, ROI или eCPM) в рамках текущей итерации.
  - Интеграция модели с системой показа рекламы и API в реальном времени.

- **Описание результата с точки зрения качества кода и воспроизводимости решения (Data Scientist)**:  
  - Код должен соответствовать PEP8, иметь докстринги, и проходить проверки линтеров.
  - Решение будет воспроизводимым, с использованием контейнеров (например, Docker) для упрощения развертывания модели.

- **Описание планируемого технического долга (что оставляем для дальнейшей продуктивизации) (Data Scientist)**:  
  - Интеграция модели в рабочее окружение.
  - Настройка и автоматизация обновления модели с использованием новых данных.
  - Оптимизация модели для работы в реальном времени с более низкими задержками.

---

### 1.4. Предпосылки решения

- **Описание всех общих предпосылок решения, используемых в системе – с обоснованием от запроса бизнеса (Data Scientist)**:  
  - Данные о взаимодействиях пользователей с рекламой являются достаточными для предсказания вероятности клика.
  - Модель будет прогнозировать вероятность клика на основе исторических данных за последние 3 недели.
  - Модель будет работать на заранее определенном наборе пользователей и рекламных предложений.

---

## 2. Методология

### 2.1. Постановка задачи

Мы разрабатываем рекомендательную модель, которая будет предсказывать вероятность клика на рекламное объявление для каждого пользователя на основе:
- Исторических данных о взаимодействиях пользователя с рекламой.
- Характеристик рекламной кампании (например, цель кампании, категория, и т.д.).
  
Модель будет классификационной (бинарной), где цель — предсказать, кликнет ли пользователь на рекламу (класс 1) или нет (класс 0).

---

### 2.2. Блок-схема решения

![Блок-схема](/images/block-scheme.jpg)
